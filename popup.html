<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Destaques do Quadro</title>
  <script src="https://p.trellocdn.com/power-up.min.js"></script>
  <style>
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
      margin: 20px; 
      background-color: #f4f5f7; 
    }
    .carrossel { 
      max-width: 500px; 
      margin: auto; 
      background: #fff; 
      border-radius: 12px; 
      padding: 24px; 
      box-shadow: 0 4px 10px rgba(0,0,0,0.1); 
      min-height: 450px;
    }
    .slide { 
      display: none; 
      text-align: center; 
    }
    .slide.active { 
      display: block; 
    }
    .slide img { 
      width: 100%; 
      height: 220px; 
      object-fit: cover; 
      border-radius: 8px; 
      margin-bottom: 12px; 
      background-color: #eee; 
    }
    .controles { 
      text-align: center; 
      margin-top: 16px; 
    }
    button { 
      background: #0079bf; 
      color: #fff; 
      border: none; 
      padding: 8px 16px; 
      border-radius: 4px; 
      cursor: pointer; 
      margin: 0 5px; 
    }
    button:hover { 
      background: #005f8c; 
    }
    .status { 
      text-align: center; 
      color: #666; 
      padding-top: 150px;
    }
  </style>
</head>
<body>
  <div class="carrossel" id="carrossel">
    <div class="status" id="status">Carregando cartões...</div>
  </div>
  <div class="controles">
    <button id="anterior">Anterior</button>
    <button id="proximo">Próximo</button>
  </div>
  
  <script>
    const statusEl = document.getElementById('status');
    const carrosselEl = document.getElementById('carrossel');
    let slides = [];
    let atual = 0;

    function criarSlide(cartao) {
      const slide = document.createElement('div');
      slide.className = 'slide';
      const imgUrl = (cartao.attachments && cartao.attachments.length > 0) ? cartao.attachments[0].url : 'https://via.placeholder.com/500x220.png?text=Sem+Imagem';
      
      slide.innerHTML = `
        <img src="${imgUrl}" alt="Imagem do cartão">
        <h2>${cartao.name}</h2>
        <p>${cartao.desc || 'Sem descrição'}</p>
      `;
      carrosselEl.appendChild(slide);
      slides.push(slide);
    }

    function carregarCartoes(t) {
      t.cards('all').then(cartoes => {
        const ativos = cartoes.filter(c => !c.closed);
        if (ativos.length === 0) {
          statusEl.textContent = 'Nenhum cartão encontrado.';
          return;
        }
        statusEl.style.display = 'none';
        ativos.forEach(criarSlide);
        if (slides.length > 0) {
          mostrarSlide(0);
        } else {
          statusEl.textContent = 'Nenhum cartão para exibir.';
          statusEl.style.display = 'block';
        }
      });
    }
    
    function mostrarSlide(idx) {
      if (slides.length === 0) return;
      slides.forEach((slide, i) => slide.classList.toggle('active', i === idx));
      atual = idx;
    }

    document.getElementById('anterior').onclick = () => slides.length > 0 && mostrarSlide((atual - 1 + slides.length) % slides.length);
    document.getElementById('proximo').onclick = () => slides.length > 0 && mostrarSlide((atual + 1) % slides.length);

    window.TrelloPowerUp.ready(() => {
      const t = window.TrelloPowerUp.iframe();
      carregarCartoes(t);
    });
  </script>
</body>
</html> 
